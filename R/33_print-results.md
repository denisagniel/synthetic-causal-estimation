Looking at asymptotic variance results
================
dagniel
2019-05-22

``` r
library(knitr)
opts_chunk$set(warning = FALSE, message = FALSE, cache = FALSE, fig.width = 7, fig.height = 7)
```

``` r
library(tidyverse)
library(here)
library(knitr)
library(formattable)

avar_res <- read_csv(here('results/prelim_asymptotic-var-results.csv'))

## Standard error accuracy
avar_res %>%
  select(theta_0, d, j, true_se, asymp_se, boot_se, asymp_se_ratio, boot_se_ratio) %>%
  arrange(d, j, theta_0) %>% kable(digits = 3)
```

| theta\_0         | d   |    j|  true\_se|  asymp\_se|  boot\_se|  asymp\_se\_ratio|  boot\_se\_ratio|
|:-----------------|:----|----:|---------:|----------:|---------:|-----------------:|----------------:|
| ate\_bal         | ks  |    1|     0.103|      0.101|     0.102|             0.984|            0.991|
| ate\_dr          | ks  |    1|     0.108|      0.108|     0.108|             0.996|            0.996|
| ate\_ipw\_2      | ks  |    1|     1.457|      1.850|     1.722|             1.270|            1.182|
| ate\_regr        | ks  |    1|     0.101|      0.100|     0.101|             0.989|            0.997|
| ate\_sr          | ks  |    1|     0.105|      0.169|     0.184|             1.613|            1.750|
| ate\_strat       | ks  |    1|     1.012|      1.527|     1.322|             1.508|            1.306|
| cal\_match\_both | ks  |    1|     0.181|      0.371|     0.311|             2.051|            1.721|
| cal\_match\_prog | ks  |    1|     0.117|      0.138|     0.131|             1.177|            1.116|
| cal\_match\_ps   | ks  |    1|     0.990|      2.626|     1.836|             2.651|            1.854|
| match\_both      | ks  |    1|     0.378|      0.492|     0.474|             1.301|            1.254|
| match\_prog      | ks  |    1|     0.302|      0.341|     0.345|             1.131|            1.144|
| match\_ps        | ks  |    1|     0.954|      1.820|     1.480|             1.909|            1.552|
| ate\_bal         | ks  |    2|     0.102|      0.101|     0.102|             0.989|            0.996|
| ate\_dr          | ks  |    2|     1.406|      1.403|     1.473|             0.998|            1.048|
| ate\_ipw\_2      | ks  |    2|     1.609|      1.874|     1.803|             1.164|            1.121|
| ate\_regr        | ks  |    2|     1.667|      1.622|     1.644|             0.973|            0.986|
| ate\_sr          | ks  |    2|     0.767|      1.036|     0.997|             1.351|            1.300|
| ate\_strat       | ks  |    2|     1.146|      1.560|     1.492|             1.361|            1.302|
| cal\_match\_both | ks  |    2|     1.068|      1.937|     1.658|             1.813|            1.552|
| cal\_match\_prog | ks  |    2|     2.194|      2.386|     2.349|             1.088|            1.070|
| cal\_match\_ps   | ks  |    2|     1.294|      2.685|     2.227|             2.075|            1.721|
| match\_both      | ks  |    2|     0.678|      0.868|     0.860|             1.281|            1.269|
| match\_prog      | ks  |    2|     2.078|      2.089|     2.119|             1.005|            1.020|
| match\_ps        | ks  |    2|     1.124|      1.860|     1.707|             1.655|            1.519|
| ate\_bal         | ld  |    1|     0.118|      0.117|     0.117|             0.991|            0.994|
| ate\_dr          | ld  |    1|     0.129|      0.135|     0.134|             1.045|            1.031|
| ate\_ipw\_2      | ld  |    1|     0.436|      0.505|     0.478|             1.160|            1.097|
| ate\_regr        | ld  |    1|     0.111|      0.111|     0.112|             1.009|            1.015|
| ate\_sr          | ld  |    1|     0.121|      0.134|     0.131|             1.108|            1.083|
| ate\_strat       | ld  |    1|     0.227|      0.248|     0.242|             1.093|            1.066|
| cal\_match\_both | ld  |    1|     0.124|      0.161|     0.152|             1.300|            1.227|
| cal\_match\_prog | ld  |    1|     0.124|      0.156|     0.147|             1.261|            1.189|
| cal\_match\_ps   | ld  |    1|     0.153|      0.260|     0.223|             1.700|            1.456|
| match\_both      | ld  |    1|     0.163|      0.172|     0.173|             1.055|            1.065|
| match\_prog      | ld  |    1|     0.163|      0.166|     0.168|             1.015|            1.031|
| match\_ps        | ld  |    1|     0.193|      0.227|     0.221|             1.176|            1.147|
| ate\_bal         | ld  |    2|     0.122|      0.118|     0.118|             0.966|            0.970|
| ate\_dr          | ld  |    2|     0.172|      0.191|     0.188|             1.109|            1.094|
| ate\_ipw\_2      | ld  |    2|     0.445|      0.514|     0.483|             1.154|            1.085|
| ate\_regr        | ld  |    2|     0.176|      0.177|     0.176|             1.005|            1.001|
| ate\_sr          | ld  |    2|     0.156|      0.172|     0.190|             1.097|            1.213|
| ate\_strat       | ld  |    2|     0.221|      0.249|     0.241|             1.125|            1.090|
| cal\_match\_both | ld  |    2|     0.145|      0.209|     0.191|             1.441|            1.316|
| cal\_match\_prog | ld  |    2|     0.205|      0.248|     0.238|             1.208|            1.160|
| cal\_match\_ps   | ld  |    2|     0.155|      0.261|     0.227|             1.679|            1.458|
| match\_both      | ld  |    2|     0.177|      0.189|     0.189|             1.066|            1.065|
| match\_prog      | ld  |    2|     0.219|      0.227|     0.226|             1.038|            1.033|
| match\_ps        | ld  |    2|     0.194|      0.229|     0.224|             1.184|            1.158|

``` r
## Confidence interval coverage
avar_res %>%
  select(theta_0, d, j, bias, asymp_se_ratio, boot_se_ratio, asymp_ci_coverage, boot_nci_coverage, boot_qci_coverage) %>%
  arrange(d, j, theta_0) %>% kable(digits = 3)
```

| theta\_0         | d   |    j|    bias|  asymp\_se\_ratio|  boot\_se\_ratio|  asymp\_ci\_coverage|  boot\_nci\_coverage|  boot\_qci\_coverage|
|:-----------------|:----|----:|-------:|-----------------:|----------------:|--------------------:|--------------------:|--------------------:|
| ate\_bal         | ks  |    1|  -0.005|             0.984|            0.991|                0.951|                0.954|                0.939|
| ate\_dr          | ks  |    1|  -0.008|             0.996|            0.996|                0.948|                0.948|                0.936|
| ate\_ipw\_2      | ks  |    1|  -0.306|             1.270|            1.182|                0.951|                0.969|                0.894|
| ate\_regr        | ks  |    1|  -0.004|             0.989|            0.997|                0.948|                0.955|                0.942|
| ate\_sr          | ks  |    1|  -0.006|             1.613|            1.750|                0.972|                1.000|                0.954|
| ate\_strat       | ks  |    1|  -1.397|             1.508|            1.306|                0.923|                0.878|                0.840|
| cal\_match\_both | ks  |    1|  -0.041|             2.051|            1.721|                1.000|                0.999|                1.000|
| cal\_match\_prog | ks  |    1|  -0.011|             1.177|            1.116|                0.979|                0.972|                0.960|
| cal\_match\_ps   | ks  |    1|  -0.189|             2.651|            1.854|                1.000|                0.999|                1.000|
| match\_both      | ks  |    1|  -0.661|             1.301|            1.254|                0.829|                0.776|                0.565|
| match\_prog      | ks  |    1|  -0.613|             1.131|            1.144|                0.625|                0.629|                0.195|
| match\_ps        | ks  |    1|  -0.835|             1.909|            1.552|                0.997|                0.980|                0.988|
| ate\_bal         | ks  |    2|  -0.005|             0.989|            0.996|                0.948|                0.954|                0.938|
| ate\_dr          | ks  |    2|  -0.211|             0.998|            1.048|                0.966|                0.955|                0.924|
| ate\_ipw\_2      | ks  |    2|  -0.393|             1.164|            1.121|                0.923|                0.972|                0.895|
| ate\_regr        | ks  |    2|  -6.342|             0.973|            0.986|                0.018|                0.035|                0.011|
| ate\_sr          | ks  |    2|  -1.526|             1.351|            1.300|                0.733|                0.716|                0.751|
| ate\_strat       | ks  |    2|  -1.786|             1.361|            1.302|                0.851|                0.842|                0.828|
| cal\_match\_both | ks  |    2|  -0.239|             1.813|            1.552|                0.999|                0.989|                1.000|
| cal\_match\_prog | ks  |    2|  -8.924|             1.088|            1.070|                0.020|                0.024|                0.004|
| cal\_match\_ps   | ks  |    2|  -0.307|             2.075|            1.721|                1.000|                0.997|                1.000|
| match\_both      | ks  |    2|  -1.471|             1.281|            1.269|                0.623|                0.623|                0.459|
| match\_prog      | ks  |    2|  -8.797|             1.005|            1.020|                0.006|                0.011|                0.001|
| match\_ps        | ks  |    2|  -1.022|             1.655|            1.519|                0.985|                0.977|                0.986|
| ate\_bal         | ld  |    1|  -0.008|             0.991|            0.994|                0.949|                0.957|                0.930|
| ate\_dr          | ld  |    1|  -0.013|             1.045|            1.031|                0.952|                0.969|                0.946|
| ate\_ipw\_2      | ld  |    1|  -0.124|             1.160|            1.097|                0.895|                0.957|                0.836|
| ate\_regr        | ld  |    1|  -0.006|             1.009|            1.015|                0.946|                0.956|                0.945|
| ate\_sr          | ld  |    1|  -0.010|             1.108|            1.083|                0.960|                0.966|                0.952|
| ate\_strat       | ld  |    1|  -0.474|             1.093|            1.066|                0.538|                0.519|                0.374|
| cal\_match\_both | ld  |    1|  -0.014|             1.300|            1.227|                0.985|                0.979|                0.976|
| cal\_match\_prog | ld  |    1|  -0.016|             1.261|            1.189|                0.985|                0.977|                0.973|
| cal\_match\_ps   | ld  |    1|  -0.023|             1.700|            1.456|                0.997|                0.991|                0.999|
| match\_both      | ld  |    1|  -0.252|             1.055|            1.065|                0.720|                0.735|                0.538|
| match\_prog      | ld  |    1|  -0.274|             1.015|            1.031|                0.634|                0.646|                0.438|
| match\_ps        | ld  |    1|  -0.269|             1.176|            1.147|                0.818|                0.816|                0.688|
| ate\_bal         | ld  |    2|  -0.012|             0.966|            0.970|                0.947|                0.954|                0.938|
| ate\_dr          | ld  |    2|  -0.031|             1.109|            1.094|                0.945|                0.970|                0.915|
| ate\_ipw\_2      | ld  |    2|  -0.141|             1.154|            1.085|                0.869|                0.957|                0.834|
| ate\_regr        | ld  |    2|  -0.453|             1.005|            1.001|                0.262|                0.259|                0.235|
| ate\_sr          | ld  |    2|  -0.191|             1.097|            1.213|                0.817|                0.869|                0.805|
| ate\_strat       | ld  |    2|  -0.520|             1.125|            1.090|                0.435|                0.415|                0.321|
| cal\_match\_both | ld  |    2|  -0.036|             1.441|            1.316|                0.984|                0.984|                0.981|
| cal\_match\_prog | ld  |    2|  -0.457|             1.208|            1.160|                0.543|                0.514|                0.457|
| cal\_match\_ps   | ld  |    2|  -0.032|             1.679|            1.458|                0.999|                0.990|                0.997|
| match\_both      | ld  |    2|  -0.341|             1.066|            1.065|                0.578|                0.579|                0.403|
| match\_prog      | ld  |    2|  -0.674|             1.038|            1.033|                0.150|                0.141|                0.066|
| match\_ps        | ld  |    2|  -0.288|             1.184|            1.158|                0.807|                0.800|                0.657|
